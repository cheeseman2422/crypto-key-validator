# Cryptocurrency Key Validator

## Overview

The **Cryptocurrency Key Validator** is a comprehensive, offline-capable GUI application built with Electron that validates cryptocurrency private keys, seed phrases, and wallet files, then checks their balances securely. It's designed specifically to work with outputs from the CryptocurrencyArtifactDetector and can also scan filesystems, folders, and entire drives for cryptocurrency artifacts.

## Key Features

### 🔐 **Secure Offline Operation**
- Complete offline functionality with local blockchain data
- Secure memory management with encryption for sensitive data
- Air-gapped environment support
- No external API calls or data transmission

### 🔍 **Focused Input Support**
- **Autopsy Integration**: Direct import from CryptocurrencyArtifactDetector results
- **Direct Input**: Paste or type keys/phrases directly
- **Secure Processing**: All input is cryptographically validated before analysis

> **Note**: Filesystem scanning is handled by Autopsy's CryptocurrencyArtifactDetector module to avoid duplication and ensure forensic integrity.

### 💰 **Comprehensive Cryptocurrency Support**
- **Bitcoin**: Legacy, SegWit, and Bech32 addresses
- **Ethereum**: Standard addresses and smart contracts
- **Monero**: Standard and integrated addresses  
- **Litecoin**: Legacy and SegWit addresses
- **Extensible**: Easy to add support for additional cryptocurrencies

### ✅ **Advanced Validation Engine**
- **Private Keys**: WIF format, hex format validation
- **Seed Phrases**: BIP39 mnemonic validation (12-24 words)
- **Wallet Files**: Bitcoin Core, Electrum, Exodus, MetaMask, Monero
- **Address Derivation**: HD wallet path derivation and address generation

### 📊 **Offline Balance Checking**
- Local blockchain database integration
- UTXO set parsing for Bitcoin-like chains
- Account state checking for Ethereum
- Cached balance data for air-gapped environments

### 🛡️ **Enterprise Security Features**
- Memory protection and secure data handling
- Private key truncation for reports
- Audit logging and access tracking
- Runtime security environment validation

## Architecture

The application is built as a monorepo with the following components:

```
CryptoKeyValidator/
├── core-engine/          # Core TypeScript library
│   ├── src/
│   │   ├── types/        # Type definitions
│   │   ├── validation/   # Crypto validation logic
│   │   ├── balance/      # Offline balance checking
│   │   ├── parsing/      # Input parsing and scanning
│   │   ├── security/     # Security and memory management
│   │   ├── engine/       # Main coordinator class
│   │   └── utils/        # Utility functions
│   └── package.json
├── app-electron/         # Electron GUI application
│   ├── src/
│   │   ├── main/         # Main Electron process
│   │   ├── renderer/     # React frontend (to be completed)
│   │   └── preload/      # Secure IPC bridge
│   └── package.json
└── docs/                 # Documentation
```

## Quick Start

### Prerequisites
- Node.js 18+ 
- pnpm (recommended) or npm
- For offline balance checking: blockchain data files

### Installation

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd CryptoKeyValidator
   ```

2. **Install dependencies**
   ```bash
   pnpm install
   ```

3. **Build the core engine**
   ```bash
   cd core-engine
   pnpm build
   cd ..
   ```

4. **Start development**
   ```bash
   cd app-electron  
   pnpm dev
   ```

### Building for Production

```bash
# Build all components
pnpm build

# Create distributables
cd app-electron
pnpm dist
```

## Usage

### Input Sources

#### 1. Autopsy Case Import
Import cryptocurrency artifacts directly from Autopsy case databases generated by the CryptocurrencyArtifactDetector:

- File → Scan Autopsy Case...
- Select the `.db` or `.sqlite` case file
- Artifacts are automatically parsed and validated

#### 2. Filesystem Scanning  
Scan any directory or drive for cryptocurrency artifacts:

- File → Scan Directory...
- Select root directory to scan
- Configure scan options (file types, size limits, etc.)
- Deep scan option for binary files

#### 3. Direct Input
Paste or type cryptocurrency data directly:

- Use the input area in the main interface
- Supports private keys, seed phrases, addresses
- Real-time validation as you type

### Artifact Types Detected

| Type | Examples | Validation |
|------|----------|------------|
| **Private Keys** | WIF format, raw hex | ✅ Format validation, address derivation |
| **Seed Phrases** | BIP39 12-24 words | ✅ Mnemonic validation, entropy check |
| **Wallet Files** | wallet.dat, *.wallet | ✅ File signature detection |
| **Addresses** | Bitcoin, Ethereum, etc. | ✅ Checksum validation |

### Balance Checking

The application supports offline balance checking through:

1. **Local Blockchain Data**: Pre-synchronized UTXO sets and account states
2. **Cached Data**: Previously downloaded balance information
3. **Derived Addresses**: Generate and check multiple address types

#### Setting Up Blockchain Data

For truly offline operation, you'll need local blockchain data:

```bash
# Bitcoin UTXO set (example structure)
blockchain-data/
├── bitcoin/
│   ├── utxo.db          # SQLite database with UTXO set
│   └── chainstate/      # Bitcoin Core chainstate
├── ethereum/
│   └── accounts.db      # LevelDB with account states
└── litecoin/
    └── utxo.db
```

*Note: Tools for blockchain data synchronization are planned for future releases.*

### Security Features

#### Memory Protection
- Sensitive data encrypted in memory
- Automatic cleanup on application exit
- Zero-overwrite of key material

#### Audit Trail
- All key access is logged
- Configurable audit retention
- Export audit logs for compliance

#### Environment Validation
- Detects development/debug environments
- Warns about potential security issues
- Runtime integrity checks

## Results and Reporting

### Dashboard View
- Summary statistics
- Risk assessment indicators
- Real-time scan progress
- Balance totals

### Results Explorer
- Filterable artifact grid
- Balance information display
- Validation status indicators
- Export capabilities

### Report Generation
- **JSON**: Machine-readable results
- **CSV**: Spreadsheet-compatible format
- **HTML**: Human-readable reports
- **Custom**: Configurable templates

## Configuration

The application uses a comprehensive configuration system:

```typescript
interface AppConfiguration {
  security: SecurityConfig;      // Memory protection, encryption
  scanning: ScanConfiguration;   // File types, size limits
  reporting: ReportConfiguration; // Output formats, content
  ui: UIConfiguration;           // Theme, language, animations
  offline: OfflineConfiguration; // Blockchain data settings
}
```

Key configuration options:
- **Security**: Enable memory protection, audit logging
- **Scanning**: File type filters, exclusion paths, size limits
- **UI**: Dark/light theme, animations, language
- **Offline**: Blockchain data path, caching settings

## Integration with CryptocurrencyArtifactDetector

The application seamlessly integrates with the existing CryptocurrencyArtifactDetector:

### Supported Artifact Types
- `TSK_CRYPTO_WALLET` → Wallet files
- `TSK_CRYPTO_ADDRESS` → Cryptocurrency addresses  
- `TSK_CRYPTO_PRIVATE_KEY` → Private keys and seeds
- `TSK_CRYPTO_TRANSACTION` → Transaction data

### Data Flow
1. CryptocurrencyArtifactDetector scans evidence → Creates Autopsy artifacts
2. CryptoKeyValidator imports artifacts → Validates and checks balances
3. Results exported for forensic reporting

## Development

### Core Engine Development
```bash
cd core-engine
pnpm dev          # Watch mode compilation
pnpm test         # Run tests
pnpm lint         # Code linting
```

### Electron App Development  
```bash
cd app-electron
pnpm dev          # Start with hot reload
pnpm build:main   # Build main process
pnpm build:renderer # Build renderer process
```

### Adding New Cryptocurrencies

1. **Add patterns** in `core-engine/src/parsing/InputParser.ts`
2. **Implement validation** in `core-engine/src/validation/CryptoValidator.ts` 
3. **Add balance checking** in `core-engine/src/balance/OfflineBalanceChecker.ts`

## Security Considerations

### For Forensic Investigators
- **Air-Gapped Operation**: Complete offline functionality
- **Data Integrity**: All artifacts include checksums and provenance
- **Chain of Custody**: Detailed audit logs and timestamps
- **Report Generation**: Court-ready documentation

### For Sensitive Environments
- **Memory Protection**: Sensitive data encrypted in RAM
- **No Network Access**: Zero external communications
- **Secure Deletion**: Proper cleanup of cryptographic material
- **Access Control**: Optional authentication and session timeouts

## Roadmap

### Version 1.1 (Planned)
- [ ] Hardware wallet integration (Ledger, Trezor)
- [ ] Blockchain data synchronization tools
- [ ] Advanced HD wallet discovery
- [ ] Multi-signature wallet support

### Version 1.2 (Future)
- [ ] Additional cryptocurrency support (Dogecoin, Zcash, etc.)
- [ ] Browser extension artifact parsing
- [ ] Advanced reporting templates
- [ ] API for programmatic access

## Contributing

We welcome contributions! Please see our contribution guidelines:

1. Fork the repository
2. Create a feature branch
3. Add tests for new functionality  
4. Ensure all tests pass
5. Submit a pull request

### Code Style
- TypeScript with strict mode
- ESLint + Prettier formatting
- Comprehensive JSDoc comments
- Security-first coding practices

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Disclaimer

This tool is designed for legitimate digital forensic investigations and personal cryptocurrency recovery. Users are responsible for ensuring proper legal authorization and following established forensic procedures. The developers assume no liability for misuse or improper application of this software.

## Support

- **Documentation**: See `/docs` directory
- **Issues**: GitHub issue tracker
- **Security**: Report vulnerabilities privately
- **Professional**: Forensic consulting available

---

**Built for Digital Forensics Professionals** 🔍  
**Secure • Offline • Comprehensive** 🛡️
